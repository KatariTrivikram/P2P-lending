<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Decentralized P2P Lending</title>
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 30px;
            background: #f1f1f1;
        }
        h2 {
            color: #333;
        }
        input, button {
            margin: 10px 0;
            padding: 8px;
            width: 100%;
        }
        button {
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
        }
        .container {
            max-width: 400px;
            margin: auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>Offer a Loan</h2>
        <input type="number" id="offerAmount" placeholder="Loan Amount in ETH">
        <input type="number" id="offerCollateral" placeholder="Collateral in ETH">
        <button onclick="offerLoan()">Offer Loan</button>

        <h2>Take a Loan</h2>
        <input type="number" id="loanIdTake" placeholder="Loan ID">
        <input type="number" id="collateralTake" placeholder="Collateral in ETH">
        <button onclick="takeLoan()">Take Loan</button>

        <h2>Repay Loan</h2>
        <input type="number" id="loanIdRepay" placeholder="Loan ID">
        <input type="number" id="repayAmount" placeholder="Repay Amount in ETH">
        <button onclick="repayLoan()">Repay Loan</button>
    </div>

    <script>
        const contractAddress = "0x820535cc905D0142871Bc129D2306fd6237A0bB0";
        const contractABI = [
            "function offerLoan(uint256 _collateral) external payable",
            "function takeLoan(uint256 _loanId) external payable",
            "function repayLoan(uint256 _loanId) external payable"
        ];

        async function getProviderAndSigner() {
            const provider = new ethers.providers.Web3Provider(window.ethereum);
            await provider.send("eth_requestAccounts", []);
            const signer = provider.getSigner();
            return { provider, signer };
        }

        async function offerLoan() {
            const amount = ethers.utils.parseEther(document.getElementById("offerAmount").value);
            const collateral = ethers.utils.parseEther(document.getElementById("offerCollateral").value);
            const { signer } = await getProviderAndSigner();
            const contract = new ethers.Contract(contractAddress, contractABI, signer);
            await contract.offerLoan(collateral, { value: amount });
            alert("Loan offered successfully!");
        }

        async function takeLoan() {
            const loanId = document.getElementById("loanIdTake").value;
            const collateral = ethers.utils.parseEther(document.getElementById("collateralTake").value);
            const { signer } = await getProviderAndSigner();
            const contract = new ethers.Contract(contractAddress, contractABI, signer);
            await contract.takeLoan(loanId, { value: collateral });
            alert("Loan taken successfully!");
        }

        async function repayLoan() {
            const loanId = document.getElementById("loanIdRepay").value;
            const repayAmount = ethers.utils.parseEther(document.getElementById("repayAmount").value);
            const { signer } = await getProviderAndSigner();
            const contract = new ethers.Contract(contractAddress, contractABI, signer);
            await contract.repayLoan(loanId, { value: repayAmount });
            alert("Loan repaid successfully!");
        }
    </script>
</body>
</html>
